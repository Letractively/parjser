(function(){if(typeof parjser==="undefined")parjser={};parjser._EOF={type:"_EOF"};parjser._DEBUGGER={type:"_DEBUGGER"};if(!parjser.grammars)parjser.grammars={}})();
(function(){parjser.Exception=function(a,c){this.type=a;c&&this.initFromTokenizer(c);return this};parjser.Exception.prototype={initFromTokenizer:function(a){this.offset=a.offset;this.text=a.originalText;this.initLineAndColumnInfo()},initLineAndColumnInfo:function(){var a=this.offset,c=this.text.substr(0,a),b=c.replace(/\n/g,"");this.line=1+c.length-b.length;b=c.lastIndexOf("\n");this.column=a-b;this.lastLine=c.substr(b,this.column)},toString:function(){return this.type+" at line "+this.line+", column "+
this.column+": "+this.lastLine}};parjser.SyntaxErrorException=function(a,c,b){this.initFromTokenizer(a);this.lastToken=c;this.lastSymbol=b};parjser.SyntaxErrorException.prototype=new parjser.Exception("SyntaxErrorException");parjser.SyntaxErrorException.prototype.toString=function(){return parjser.Exception.prototype.toString.call(this)+"\nwhile parsing "+this.lastSymbol}})()(function(){parjser.RegexTokenizer=function(a){this.init(a);return this};parjser.RegexTokenizer.prototype={init:function(a){this.tokens=
a.tokens?a.tokens:{};this.tokenNames=[null];this.groups=[null];this.ignoreCase=a.ignoreCase===true?true:false;this.ignoredTokens=a.ignoreTokens?a.ignoreTokens:{};this.offset=this.text=null;this.makeRegex(false)},makeRegex:function(a){var c,b=this.tokens,h="",f,j=0,l=this.tokenNames,q=this.groups;for(c in b){if(h!=="")h+="|";f=b[c].toString();h+="("+f.substr(1,f.length-2)+")";if(a)RegExp("^"+h,(this.ignoreCase?"i":"")+"g");else{l.push(c);f=f.replace(/\\\\/g,"");f=f.replace(/\\\(/g,"");f=f.replace(/\(\?!/g,
"");j++;q.push(j);j+=f.length-f.replace(/\(/g,"").length}}if(!a)try{this.regex=RegExp(h,(this.ignoreCase?"i":"")+"g")}catch(x){this.makeRegex(true)}},isIgnoredToken:function(a){return a.type in this.ignoredTokens},setText:function(a){this.text=this.originalText=a;this.offset=0},next:function(){var a=this.text,c=this.offset,b,h,f,j,l;if(c>=a.length)return parjser._EOF;if((a=this.regex.exec(a))===null)this.throwNoMatchException();else a.index!==this.offset&&this.throwNoMatchException();b=a[0];h=b.length;
l=this.groups;this.offset+=h;j=1;for(f=a.length;j<f;j++)if(a[l[j]]){token=this.tokenNames[j];return{text:b,len:h,off:c,type:token}}this.throwNoMatchException()},nextToken:function(){for(var a;this.isIgnoredToken(a=this.next()););return a},throwNoMatchException:function(){throw new parjser.Exception("NoMatchFound",this);}}}());
(function(){parjser.GrammarCompiler=function(){};parjser.GrammarCompiler.compile=function(a){var c,b,h,f,j=a.rules?a.rules:{},l={},q={tokens:null,tokenizer:null,rules:null,prune:a.prune?true:false};b=(a.parserClass?a.parserClass:parjser.TopDownParser).prototype;var x=b.parseEmpty,z=b.parseChoice,A=b.parseSequence,C=b.parseToken,y=function(e,d){var g,i,m,n,o,u,s,k;d||(d={first:{}});d.originalRule=e;if(e instanceof Array){g=e.length;if(g===0)d.func=x;else{m=[];d.ruleParts=m;if(e[0]==="|"){o=z;i=1}else{o=
A;i=0}d.func=o}for(u=0;i<g;i++){n=e[i];if(typeof n==="undefined")throw"Undefined rulepart at index "+i+" in rule "+JSON.stringify(e);k=n=y(n);i=i;var D=e.length,w=void 0,v=void 0;w=i+1;if(w<D){v=e[w];if(typeof v==="string"){i=w;switch(v){case "?":k.minOccurs=0;k.maxOccurs=1;break;case "+":k.minOccurs=1;k.maxOccurs=Number.POSITIVE_INFINITY;break;case "*":k.minOccurs=0;k.maxOccurs=Number.POSITIVE_INFINITY;break;default:if((match=/^\{(\d+)(,(\d+))?\}$/.exec(v))&&match[0]===v){k.minCardinality=match[1]?
parseInt(match[1],10):1;k.maxCardinality=match[3]?parseInt(match[3],10):1}else i--}}}if(typeof k.minOccurs==="undefined")k.minOccurs=1;if(typeof k.maxOccurs==="undefined")k.maxOccurs=1;i=i;k=n.first;if(o===z||o===A&&u===0)for(s in k){d.first[s]||(d.first[s]={});d.first[s][m.length]=true}u+=n.minOccurs;d.ruleParts.push(n)}if(u===0)d.minOccurs=0}else if(typeof e==="string")if(f[e]){d.token=e;d.func=C;k={};k[e]={"0":true};d.first=k}else if(j[e]){g=l[e];if(!g){g={symbol:e,minOccurs:1,maxOccurs:1,first:{}};
g.first[e]={"0":true};l[e]=g;y(j[e],g)}for(s in g)d[s]=g[s]}else throw e+" is neither a token nor a symbol.";else if(e===null)d.func=x;return d},B=function(e){var d,g,i,m;e.fixed=true;d=e.first;for(g in d){indexes=d[g];if(!(indexes instanceof Array)){m=[];for(i in indexes)m.push(parseInt(i,10));d[g]=m.sort()}}if(e=e.ruleParts){d=e.length;for(g=0;g<d;g++){i=e[g];i.fixed||B(i)}}};if(a.tokens)f=a.tokens;else{f={};r={};for(c in j){b=j[c];if(b instanceof RegExp)f[c]=b;else r[c]=b}j=r}q.tokens=f;c=a.tokenizer?
a.tokenizer:new parjser.RegexTokenizer({tokens:f,ignoreCase:a.ignoreCase,ignoreTokens:a.ignoreTokens});q.tokenizer=c;if(a.startSymbol)h=a.startSymbol;else for(h in j)break;if(!j[h])throw"No rule found for symbol "+h;q.startSymbol=h;y(h);(function(){var e,d,g,i,m,n,o,u,s;for(e in l){d=l[e];i={};d=d.first;for(g in d)if(m=l[g])i[g]=m;for(g in i){s=d[g];delete d[g];if(g!==e){m=i[g];m=m.first;for(n in m)if(!l[n]){o=d[n];if(!o){o={};d[n]=o}for(u in s)o[u]=true}}}}})();(function(){var e,d;for(e in l){d=
l[e];B(d)}})();q.rules=l;q.compiled=true;return q}})()(function(){parjser.TopDownParser=function(a){this.grammar=a.compiled?a:parjser.GrammarCompiler.compile(a);this.tokenizer=this.grammar.tokenizer;this.prune=this.grammar.prune;return this};parjser.TopDownParser.prototype={initTokenBuffer:function(){this.tokenBuffer=[];this.tokenBufferPointer=-1},nextToken:function(){var a;a=++this.tokenBufferPointer;var c=this.tokenBuffer;if(a<c.length)a=c[a];else{a=this.tokenizer.nextToken();c.push(a)}return a},
parseRule:function(a,c){for(var b,h=this.prune,f,j=0,l=a.func,q=a.maxOccurs;j<q;j++){f=this.tokenBufferPointer;b={children:[]};if(l.call(this,a,b)){b.offset=this.tokenizer.offset;b.tokenBufferPointer=f;b.type=a;b.parentNode=c;if(h){f=b.children.length;if(f===1)b=b.children[0]}c.children.push(b)}else{this.tokenBufferPointer=f;b.children=null;b.parentNode=null;b.type=null;break}}return j>=a.minOccurs},parseEmpty:function(){return true},parseToken:function(a,c){var b=this.nextToken();if(b.type===a.token){c.token=
b;return true}else return false},parseEOF:function(){return this.nextToken()===parjser._EOF},parseChoice:function(a,c){for(var b=0,h=a.ruleParts,f=h.length;b<f;b++)if(this.parseRule(h[b],c))return true;return false},parseSequence:function(a,c){for(var b=0,h=a.ruleParts,f=h.length;b<f;b++)if(!this.parseRule(h[b],c))return false;return true},initParse:function(a,c){if(!c)if(!(c=this.grammar.startSymbol))throw"No symbol specified or implied";var b=this.grammar.rules[c];b={func:parjser.TopDownParser.prototype.parseSequence,
ruleParts:[b,parjser._EOF],minOccurs:1,maxOccurs:1};this.tokenizer.setText(a);this.initTokenBuffer();this.tree={children:[]};return b},parse:function(a,c){this.parseRule(this.initParse(a,c),this.tree)||this.throwSyntaxErrorException();return this.tree.children[0].children[0]},throwSyntaxErrorException:function(){var a=this.tokenBuffer,c=a.length;throw new parjser.SyntaxErrorException(this.tokenizer,c?a[c-1]:null,this.lastSymbol?this.lastSymbol:this.currentSymbol);}};parjser._EOF.func=parjser.TopDownParser.prototype.parseEOF;
parjser._EOF.minOccurs=1;parjser._EOF.maxOccurs=1}());
